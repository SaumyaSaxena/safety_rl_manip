debug: False
gpu: 0
seed: 0
tag: ${now:%Y-%m-%d-%H-%M-%S}
run_name: "train_panda_DDPG_pickup_slide_mujoco_${train_cfg.mode}" 
# variant: ${train_cfg.warmup_cfg.warmup_type}_UpdatePiType_${train_cfg.warmup_cfg.warmupQ_expert.update_pi_type}
# variant: 'no_terminal_gammaSch150_lrSch'
variant: 'avoid_top_block'

hydra:
  run:
    dir: outputs/train/${run_name}/${tag}_${variant}
  job:
    chdir: True

defaults:
  - /envs: mujoco_envs.yaml
  - _self_

wandb:
  entity: iam-lab
  group: drabe/DDPG
  project: safety_rl_manip
  name: ${run_name}_${variant}
wandb_resume_id: null

env_name: "slide_pickup_clutter_mujoco_env-v0"
envs:
  slide_pickup_clutter_mujoco_env-v0:
    doneType: 'all'
    return_type: 'reward'
    mode: ${train_cfg.mode}
    costType: 'max_ell_g'
    epochs: ${train_cfg.epochs}

train_cfg:
  run_variant: ${variant}
  algo_name: DDPG
  warmup: False
  warmup_cfg:
    batch_size: 200
    num_epochs: 60
    warmup_q_lr: 1e-3
    warmup_pi_lr: 1e-3
    warmup_type: 'warmup_pi' # 'warmupQ_terminal_all_states', 'warmupQ_expert', 'warmup_pi'
    warmupQ_terminal_all_states:
      num_terminal_samples: 1e+4
    warmupQ_expert:
      num_mixed_terminal_samples: 1e+4
      expert_data_loc: '/home/saumyas/Projects/safe_control/HJR_manip/outputs/DoubleIntegrator/goto_goal_datasets/data_DoubleIntegrator_goto_goal_N_620.pkl'
      update_pi: True
      update_pi_type: 'expert' # 'expert', 'maxQ'
    warmup_pi:
      expert_data_loc: '/home/saumyas/Projects/safe_control/HJR_manip/outputs/DoubleIntegrator/goto_goal_datasets/data_DoubleIntegrator_goto_goal_N_620.pkl'
  add_expert_to_buffer: False
  expert_data_loc: '/home/saumyas/Projects/safe_control/HJR_manip/outputs/DoubleIntegrator/goto_goal_datasets/data_DoubleIntegrator_goto_goal_N_620.pkl'
  expert_data_frac: 0.75
  mode: 'lagrange' # RA, lagrange
  seed: ${seed}
  steps_per_epoch: 4000
  epochs: 400
  replay_size: 1e+6
  gamma: 0.99
  schedule_gamma: False
  gamma_warmup_epochs: 150
  scale_q_loss: 1000.0
  polyak: 0.995
  pi_lr: 1e-3 
  q_lr: 1e-3
  AdamW:
    eps: 1.0e-8
    weight_decay: 0.01
  scheduler:
    sched: cosine
    # epochs are updated in code: epochs <- total_epochs - warmup - cooldown
    epochs: ${train_cfg.epochs}  # Total epochs to run (warmup + decay + cooldown)
    min_lr: 1.0e-5
    warmup_lr: 1.0e-4
    warmup_epochs: 10
    cooldown_epochs: 0
  batch_size: 200
  start_steps: 10000
  update_after: 1000
  update_every: 50
  act_noise: 0.1
  schedule_noise: False
  noise_decay: 0.985
  num_test_episodes: 20
  max_ep_len: 300
  model_save_freq: 2
  plot_save_freq: 10
  save_top_k: 5
  ac_kwargs:
    hidden_sizes: [256,256]
  resume_from_ckpt: False
  wandb_load:
    run_path: iam-lab/safety_rl_manip/cxrjqc41 # iam-lab/safety_rl_manip/lxqxti1m
    file: model/step_1591999_test_return_-2.19.pth # model/step_1207999_test_return_-2.37.pth

eval_cfg:
  seed: ${seed}
  eval_value_fn: False
  test_value_fn: False
  num_test_episodes: 100
  eval_safe_rollouts: True
  num_eval_episodes: 5000
  save_rollout_gifs: True  